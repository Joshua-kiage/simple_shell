#include <stdio.h>
#include <stdlib.h>

/**
 * inbuilt_getline - Read a line from a file stream
 * @lineptr: Pointer to the buffer storing the line
 * @n: Pointer to the size of the buffer
 * @stream: File stream to read from
 *
 * Description: This function reads a line from the specified file stream,
 * dynamically allocates memory for the line, and automatically expands
 * the buffer size as needed. The function returns the number of characters
 * read (excluding the newline character) or -1 if an error occurs.
 *
 * Return: The number of characters read (excluding newline) on success,
 *         or -1 if an error occurs.
 */
ssize_t inbuilt_getline(char **lineptr, size_t *n, FILE *stream)
{
    if (lineptr == NULL || n == NULL || stream == NULL)
    {
        return -1;
    }

    int ch;
    size_t i = 0;
    size_t size = *n;
    char *buffer = *lineptr;

    while ((ch = fgetc(stream)) != EOF)
    {
        if (i + 1 >= size)
        {
            size *= 2;
            char *new_buffer = (char *)realloc(buffer, size);
            if (new_buffer == NULL)
            {
                return -1; /* Error: Unable to reallocate memory */
            }
            buffer = new_buffer;
        }
        buffer[i++] = (char)ch;
        if (ch == '\n')
        {
            break;
        }
    }

    if (i == 0)
    {
        return -1; /* Error: No characters read */
    }

    buffer[i] = '\0';
    *lineptr = buffer;
    *n = size;

    return i;
}

